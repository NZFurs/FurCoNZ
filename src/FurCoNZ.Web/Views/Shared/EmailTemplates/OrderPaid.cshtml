@using FurCoNZ.Web.Helpers
@model OrderViewModel
@{
    ViewData["Title"] = "Your Order";
    ViewData["ButtonTitle"] = "View Your Order";
    ViewData["ButtonUrl"] = $"{Context.Request.Scheme}://{Context.Request.Host}/Account/Orders";
}

@* The <tr></tr> content was generated by mjml, cropped so that it fits in nicely with the rest of the generated email template *@
<tr>
    <td align="left" style="font-size:0px;padding:10px 25px;word-break:break-word;">
        <div style="font-family:Raleway;font-size:13px;line-height:1;text-align:left;color:#FFFFFF;">
            Hi there! Your tickets have been paid for!
        </div>
    </td>
</tr>

<tr>
    <td align="left" style="font-size:0px;padding:10px 25px;word-break:break-word;">
        <div style="font-family:Raleway;font-size:13px;line-height:1;text-align:left;color:#FFFFFF;">
            Here is your order below. If there is anything wrong, please contact us to have them corrected.
        </div>
    </td>
</tr>

    <tr>
        <td align="left" class="ticket" style="font-size:0px;padding:10px 25px;word-break:break-word;">
            <table cellpadding="0" cellspacing="0" width="100%" border="0" style="cellspacing:0;color:#FFFFFF;font-family:Raleway;font-size:13px;line-height:22px;table-layout:auto;width:100%;">
                @foreach (var ticket in Model.Tickets)
                {
                    <tr>
                        <td colspan="2" style="width: 99%;" width="99%">
                            <h3 class="sub-heading" style="font-size: 24px; font-family: 'Limelight'; color: #DAA520; margin: 10px 0;">Ticket #@ticket.Id<small class="muted" style="color: #ADAFAE;"> - @ticket.BadgeName</small></h3>
                        </td>
                    </tr>

                    var dateAtCon = ticket.DateOfBirth.GetAgeAtDate(DateTime.Parse("2020-01-30"));
                    @if (dateAtCon < 18 && dateAtCon >= 16)
                    {
                        <tr>
                            <td colspan="2" style="background-color: #2A9FD6; padding: 10px 25px"> <strong>A parental consent form will be required to attend this event, or be accompanied by a parent or legal guardian.</strong> </td>
                        </tr>
                    }
                    else if (dateAtCon < 16)
                    {
                        <tr>
                            <td colspan="2" style="background-color: #f80; padding: 10px 25px"> <strong>The ticket holder must be accompanied by a parent or legal guardian.</strong> </td>
                        </tr>
                    }
                    @if (ticket.TermsAndConditions != TermsAndConditions.Accepted)
                    {
                        <tr>
                            <td colspan="2" style="background-color: #c00; padding: 10px 25px"> <strong>The person you are buying a ticket for must read and agree to the <a href="@($"{Context.Request.Scheme}://{Context.Request.Host}/Home/Terms")" target="_blank">FurCoNZ 2020 terms and conditions</a>. If attendee refuses to agree to Terms and Conditions during on-site Registration, then Registration will be refused and no refund will be given.</strong> </td>
                        </tr>
                    }
                    <tr>
                        <td colspan="2" style="width: 99%;" width="99%">
                            <h4 style="font-size: 20px; font-family: 'Limelight'; color: #FFF; margin: 10px 0;">@ticket.TicketType.Name</h4>
                        </td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Badge Name:</th>
                        <td style="width: 99%;" width="99%">@ticket.BadgeName</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Email Address:</th>
                        <td style="width: 99%;" width="99%">@ticket.EmailAddress</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Full Name:</th>
                        <td style="width: 99%;" width="99%">@ticket.IdentificationFullName</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Prefered Name:</th>
                        <td style="width: 99%;" width="99%">@ticket.PreferredFullName</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Dietry Requirements:</th>
                        <td style="width: 99%;" width="99%">@(string.Join(", ", ticket.DietryRequirements.Select(f => f.ToString())))</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Known Allergies:</th>
                        <td style="width: 99%;" width="99%">@ticket.KnownAllergies</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Cabin Preferences:</th>
                        <td style="width: 99%;" width="99%">@ticket.CabinPreferences</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Other Notes:</th>
                        <td style="width: 99%;" width="99%">@ticket.OtherNotes</td>
                    </tr>
                    <tr>
                        <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Cost:</th>
                        <td style="width: 99%;" width="99%">@ticket.TicketType.Price.ToString("C")</td>
                    </tr>
                    <tr>
                        <td colspan="2" style="width: 99%;" width="99%">
                            <hr style="border-color: #fff; border-width: 1px;" />
                        </td>
                    </tr>
                }
                <tr>
                    <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Total:</th>
                    <td style="width: 99%;" width="99%"><b>@Model.AmountTotal.ToString("C")</b></td>
                </tr>
                @* TODO: only display this if GST is enabled *@
                @*<tr>
                    <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">GST (included):</th>
                    <td style="width: 99%;" width="99%"><b>@((Model.AmountTotal * 3 / 23).ToString("C"))</b></td>
                </tr>*@
                <tr>
                    <td colspan="2" style="width: 99%;" width="99%">
                        <hr style="border-color: #fff; border-width: 1px;" />
                    </td>
                </tr>
                <tr>
                    <th style="width: auto; text-align: right; padding-right: 8px; white-space: nowrap;" align="right">Paid:</th>
                    <td style="width: 99%;" width="99%"><b>@Model.AmountPaid.ToString("C")</b></td>
                </tr>
            </table>
        </td>
    </tr>

@section Footer{ 
    @await Html.PartialAsync("~/Views/Shared/EmailTemplates/_Terms.cshtml")
}